<script setup lang="ts">
const { node } = defineProps({
  node: { type: Object, default: null },
})

const salePercentage = computed((): number => {
  const salePrice = parseFloat(node.salePrice.replace(/\D/g, ""))
  const regularPrice = parseFloat(node.regularPrice.replace(/\D/g, ""))
  return Math.round(((salePrice - regularPrice) / regularPrice) * 100)
})
</script>

<template>
  <span v-if="node.salePrice" class="green-badge">
    <svg
      width="19"
      height="18"
      viewBox="0 0 19 18"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        d="M11.1219 0.74566C10.1875 -0.0506396 8.81316 -0.0506312 7.87883 0.745652L6.75546 1.70295C6.62199 1.81669 6.45604 1.88543 6.28123 1.89938L4.80999 2.01679C3.58622 2.11444 2.61444 3.08622 2.51679 4.30999L2.39939 5.78122C2.38544 5.95602 2.31669 6.12201 2.20294 6.25548L1.24564 7.37882C0.449361 8.31324 0.44937 9.68749 1.24566 10.6218L2.20296 11.7452C2.31669 11.8787 2.38543 12.0447 2.39938 12.2195L2.5168 13.6907C2.61446 14.9144 3.58624 15.8862 4.81003 15.9838L6.28124 16.1013C6.45604 16.1152 6.62195 16.184 6.75542 16.2977L7.87874 17.255C8.81316 18.0512 10.1875 18.0513 11.1219 17.255L12.2452 16.2977C12.3787 16.184 12.5446 16.1152 12.7194 16.1012L14.1907 15.9838C15.4144 15.8862 16.3862 14.9145 16.4839 13.6907L16.6012 12.2195C16.6152 12.0447 16.684 11.8787 16.7977 11.7452L17.755 10.6219C18.5513 9.68748 18.5513 8.31315 17.755 7.37882L16.7977 6.25544C16.6839 6.12197 16.6152 5.95602 16.6013 5.78123L16.4839 4.30999C16.3862 3.08624 15.4144 2.11443 14.1907 2.01678L12.7194 1.89937C12.5446 1.88542 12.3787 1.81669 12.2452 1.70295L11.1219 0.74566ZM11.8572 5.46489L13.0357 6.6434L7.14309 12.536L5.96458 11.3574L11.8572 5.46489ZM8.02699 7.52724C7.53881 8.0154 6.74736 8.0154 6.2592 7.52724C5.77105 7.03915 5.77105 6.24767 6.2592 5.75951C6.74736 5.27135 7.53881 5.27135 8.02699 5.75951C8.51516 6.24767 8.51516 7.03915 8.02699 7.52724ZM10.9732 12.2413C10.4851 11.7532 10.4851 10.9617 10.9732 10.4736C11.4614 9.9854 12.2528 9.9854 12.741 10.4736C13.2292 10.9617 13.2292 11.7532 12.741 12.2413C12.2528 12.7295 11.4614 12.7295 10.9732 12.2413Z"
        fill="white"
      />
    </svg>
    {{ salePercentage }}%
  </span>
</template>

<style lang="postcss" scoped>
.green-badge {
  @apply z-10 inline-flex items-center gap-2 rounded-full bg-green-300 px-2 py-0.5 text-sm font-bold leading-6 tracking-tight text-white;
  background: #000 linear-gradient(0deg, #6fcf97, #6fcf97);
}
</style>
